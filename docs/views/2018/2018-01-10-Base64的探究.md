---
title: Base64的探究
date: 2018-01-10
permalink: /:year/:month/:day/:slug
tags:
 - 算法 
categories: 
 - JavaScript
sidebar: false
publish: true
---

> Base64 是一组相似的二进制到文本（binary-to-text）的编码规则，使得二进制数据在解释成 radix-64 的表现形式后能够用 ASCII 字符串的格式表示出来。Base64 这个词出自一种 MIME 数据传输编码。 在 JavaScript 中，有两个函数被分别用来处理解码和编码 base64 字符串：

```js
window.atob() // 解码通过base-64编码的字符串数据
window.btoa() // 二进制数据'字符串'创建一个base-64编码的ASCII字符串
```

##  1.base64的转换
::: tip
算法核心:</br>
    1: Base64编码要求把3个8位字节（3*8=24）转化为 4个6位的字节（4*6=24</br>
    2: 之后在6位的前面补两个0，形成新的8位一个字节的形式</br>
    3: 根据Base64编码对照表（见下图）获得对应的值。</br>
    4: 编码的字节数小于24位 eg:(一个字节 8bit，两个字节16bit) 则需要采用 = 进行补位
::: 

```js
    2: char base64=
       ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P',
       'Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f',
       'g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v',
       'w','x','y','z','0','1','2','3','4','5','6','7','8','9','+','/',];
```
## 
```js
例子:
//1: 得到十六进制的数
var buffer = Buffer.from('小布丁');
console.log(buffer);  //得到十六进制的数:  e5 b0 8f e5 b8 83 e4 b8 81

//2: 将十六进制转换成十进制
let decimalism = []
for (let index = 0; index < buffer.length; index++) {
    let element = buffer[index];
    decimalism.push(element)
}
console.log("decimalism", decimalism);
// [229, 176, 143, 229, 184, 131, 228, 184, 129]

//3: 将十进制转换成二进制
let binary = []
for (let index = 0; index < decimalism.length; index++) {
    let element = (decimalism[index]).toString(2);
    binary.push(element)
}
console.log("binary", binary);
// [11100101, 10110000, 10001111, 11100101, 10111000, 10000011, 11100100, 10111000, 10000001]
let binaryNumber = '111001011011000010001111111001011011100010000011111001001011100010000001'
console.log("binaryNumber", binaryNumber.length) // 72 

//4. 将 8位 字节转换成 6位 字节, 之后在前面补两个0 形成一个新的8位字节
let splitBinaryNumber = [];
for (let index = 0; index < binaryNumber.length; index++) {
    if (index % 6 == 0) {
        let str = binaryNumber.substr(index, 6)
        splitBinaryNumber.push(`00${str}`)
    }
}
console.log("splitBinaryNumber", splitBinaryNumber)
// ['00111001', '00011011', '00000010', '00001111', '00111001', '00011011', '00100010', '00000011', '00111001', '00001011', '00100010', '00000001' ]

//5: 将每8位对应的字符进行获取
var base64= ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P',
        'Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f',
        'g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v',
        'w','x','y','z','0','1','2','3','4','5','6','7','8','9','+','/',];
let base64Code = ''
for (let index = 0; index < splitBinaryNumber.length; index++) {
    let element = Number(splitBinaryNumber[index])
    let baseIndex =  parseInt(element, 2)
    base64Code += base64[baseIndex]
    
}
console.log("base64Code", base64Code) // 5bCP5biD5LiB // 
let bufferBase64 = Buffer.from(bufferBase64,'base64');
console.log("bufferBase64", bufferBase64.toString());  // 小布丁
```

