---
title: Js中的运动函数
date: 2018-05-04
tags:
 - JS运动       
categories: 
 - 前端
sidebar: false
---

## 缓冲运动函数

```js     
// 获取属性值
function getStyle (dom, attr) {
    if (window.getComputedStyle) {
        return window.getComputedStyle(dom, null)[attr];
    }else {
        return dom.currentStyle[attr];
    }
}


// 缓冲运动函数 
function startMove (dom, attrObj, callback) {
    // 清除所属的定时器
    clearInterval(dom.timer);
    // 声明速度和，当前变化值
    var iSpeed = null, iCur = null;
    dom.timer = setInterval(function () {
        // 加上已经可以停止了
        var bStop = true;

        for (var attr in attrObj) {
            // 如果是 opacity 处于 0 --- 1 之间 直接放大 100 倍进行
            if (attr == 'opacity') {
                iCur = parseFloat( getStyle(dom, attr) ) * 100;
            }else {
                iCur = parseInt( getStyle(dom, attr) );
            }
            // 计算速度 目标值 - 当前值 / 一个特定数值 （随便给）
            iSpeed = (attrObj[attr] - iCur) / 7;
            // 对于速度的正负 分别向上 以及向下取整
            iSpeed = iSpeed > 0 ? Math.ceil(iSpeed) : Math.floor(iSpeed);
            // 同理判断是不是透明度 此时最后的属性 要 缩小 100 
            if (attr == 'opacity') {
                dom.style.opacity = (iCur + iSpeed) / 100; 
            }else {
                dom.style[attr] = iCur + iSpeed + 'px';
            }
            // 判断变化值是不是等于 每个属性的目标值 
            if (iCur != attrObj[attr]) {
                bStop = false;
            }
        }
        if (bStop) {
            // 完成运动以后 清楚定时器 ，进行回调
            clearInterval(dom.timer);
            typeof callback == 'function' && callback();
        }
    }, 30);
}

```




